@model IEnumerable<FurnitureShop.Models.Product>
@{
    ViewData["Title"] = "Trang ch·ªß";
}

<!-- üåü Hero Section (hi·ªáu ·ª©ng parallax + fade-in) -->
<section class="hero-section text-center text-white d-flex align-items-center justify-content-center">
    <div class="overlay"></div>

    <div class="content text-center">
        <h1 class="display-3 fw-bold mb-3 animate-fade">‚ú® Furniture Shop ‚ú®</h1>
        <p class="lead mb-4 animate-fade-delay">Mang ƒë·∫øn cho b·∫°n kh√¥ng gian s·ªëng hi·ªán ƒë·∫°i, sang tr·ªçng v√† tinh t·∫ø.</p>
        <a asp-controller="Products" asp-action="Index" class="btn btn-primary btn-lg px-4 py-2 shadow-lg animate-fade-delay2">
            <i class="bi bi-bag-heart"></i> Mua s·∫Øm ngay
        </a>
    </div>
</section>

<style>
    /* üèîÔ∏è Ph·∫ßn n·ªÅn Parallax */
    .hero-section {
        position: relative;
        height: 80vh;
        background: url('/images/banner.jpg') center center / cover no-repeat fixed;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
    }

        /* üï∂Ô∏è Overlay m·ªù tr√™n ·∫£nh */
        .hero-section .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.45);
            z-index: 1;
        }

        /* üìù N·ªôi dung ch√≠nh */
        .hero-section .content {
            position: relative;
            z-index: 2;
            color: #fff;
            text-shadow: 0 3px 10px rgba(0, 0, 0, 0.5);
            animation: fadeInUp 1.5s ease;
        }

    /* üåà Hi·ªáu ·ª©ng fade-in */
    @@keyframes fadeInUp {
        from

    {
        opacity: 0;
        transform: translateY(30px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }

    }

    /* C√°c l·ªõp tr·ªÖ hi·ªáu ·ª©ng */
    .animate-fade {
        animation: fadeInUp 1.2s ease forwards;
    }

    .animate-fade-delay {
        animation: fadeInUp 1.8s ease forwards;
        opacity: 0;
        animation-delay: 0.3s;
    }

    .animate-fade-delay2 {
        animation: fadeInUp 2.2s ease forwards;
        opacity: 0;
        animation-delay: 0.6s;
    }

    /* üîò N√∫t mua s·∫Øm */
    .hero-section .btn-primary {
        font-size: 1.2rem;
        border-radius: 50px;
        background: linear-gradient(90deg, #007bff, #00c4ff);
        border: none;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

        .hero-section .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0, 195, 255, 0.5);
        }
</style>


<div class="container mt-5">

    <!-- üéüÔ∏è Coupon n·ªïi b·∫≠t -->
    <div class="alert alert-success text-center shadow-sm py-3 fw-semibold coupon-banner">
        <i class="bi bi-ticket-perforated fs-4 text-danger"></i>
        üî• M√£ gi·∫£m gi√° h√¥m nay:
        <strong class="text-uppercase text-danger">
            @{
                var randomCoupons = new[] { "SALE10", "VIP5", "FURNI15", "NOITHAT20" };
                var random = new Random();
                var coupon = randomCoupons[random.Next(randomCoupons.Length)];
            }
            @coupon
        </strong>
        ‚Äì Gi·∫£m <strong>@(random.Next(5, 20))%</strong> cho ƒë∆°n h√†ng h√¥m nay!
        <a asp-controller="Coupons" asp-action="Index" class="btn btn-sm btn-warning ms-2 shadow-sm">
            <i class="bi bi-gift"></i> Xem t·∫•t c·∫£ m√£
        </a>
    </div>

    <!-- üîç Thanh t√¨m ki·∫øm v√† l·ªçc -->
    <form asp-controller="Home" asp-action="Index" method="get" class="mb-4 bg-light p-3 rounded shadow-sm">
        <div class="row g-2 align-items-center">
            <div class="col-md-4">
                <input type="text" name="search" class="form-control" placeholder="T√¨m s·∫£n ph·∫©m..."
                       value="@ViewBag.Search" />
            </div>
            <div class="col-md-2">
                <input type="number" name="minPrice" class="form-control" placeholder="Gi√° t·ªëi thi·ªÉu"
                       value="@ViewBag.MinPrice" />
            </div>
            <div class="col-md-2">
                <input type="number" name="maxPrice" class="form-control" placeholder="Gi√° t·ªëi ƒëa"
                       value="@ViewBag.MaxPrice" />
            </div>
            <div class="col-md-3">
                <select name="sort" class="form-select">
                    <option value="">S·∫Øp x·∫øp: M·ªõi nh·∫•t</option>
                    <option value="price_asc" selected="@(ViewBag.Sort=="price_asc")">Gi√° tƒÉng d·∫ßn</option>
                    <option value="price_desc" selected="@(ViewBag.Sort=="price_desc")">Gi√° gi·∫£m d·∫ßn</option>
                </select>
            </div>
            <div class="col-md-1">
                <button type="submit" class="btn btn-primary w-100">
                    <i class="bi bi-search"></i>
                </button>
            </div>
        </div>
    </form>

    <!-- üåü Carousel s·∫£n ph·∫©m n·ªïi b·∫≠t -->
    <div id="highlightCarousel" class="carousel slide mb-5 shadow-sm rounded" data-bs-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="/images/sp1.jpg" class="d-block w-100 rounded" alt="S·∫£n ph·∫©m 1" style="height:400px;object-fit:cover;">
            </div>
            <div class="carousel-item">
                <img src="/images/sp2.jpg" class="d-block w-100 rounded" alt="S·∫£n ph·∫©m 2" style="height:400px;object-fit:cover;">
            </div>
            <div class="carousel-item">
                <img src="/images/sp3.jpg" class="d-block w-100 rounded" alt="S·∫£n ph·∫©m 3" style="height:400px;object-fit:cover;">
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#highlightCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#highlightCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
        </button>
    </div>

    <!-- üõí Danh s√°ch s·∫£n ph·∫©m -->
    <h2 class="mb-4 fw-bold text-uppercase">üÜï S·∫£n ph·∫©m m·ªõi nh·∫•t</h2>

    @if (Model != null && Model.Any())
    {
        <div class="row g-4">
            @foreach (var p in Model.Take(6))
            {
                <div class="col-md-4">
                    <div class="card h-100 shadow-sm border-0 rounded-3 product-card">
                        <div class="position-relative overflow-hidden rounded">
                            <img src="@(string.IsNullOrWhiteSpace(p.ImageUrl) ? "/images/no-image.png" : p.ImageUrl)"
                                 class="card-img-top img-fluid"
                                 alt="@p.Name" />
                            <span class="badge bg-danger position-absolute top-0 start-0 m-2 shadow">M·ªõi</span>
                        </div>

                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title text-truncate" data-bs-toggle="tooltip" title="@p.Name">@p.Name</h5>
                            <p class="card-text text-truncate" data-bs-toggle="tooltip" title="@p.Description">@p.Description</p>

                            <div class="mt-auto d-flex justify-content-between align-items-center">
                                <span class="fw-bold text-primary fs-5">@($"{p.Price:N0} ƒë")</span>

                                <form asp-controller="Cart" asp-action="Add" method="post" class="d-inline add-to-cart-form">
                                    <input type="hidden" name="productId" value="@p.Id" />
                                    @Html.AntiForgeryToken()
                                    <button type="submit" class="btn btn-sm btn-success">
                                        <i class="bi bi-cart-plus"></i> Th√™m gi·ªè
                                    </button>
                                </form>

                                <a class="btn btn-sm btn-outline-primary" asp-controller="Products" asp-action="Details" asp-route-id="@p.Id">
                                    <i class="bi bi-eye"></i> Chi ti·∫øt
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <div class="alert alert-info text-center">Hi·ªán ch∆∞a c√≥ s·∫£n ph·∫©m n√†o ƒë·ªÉ hi·ªÉn th·ªã.</div>
    }
</div>

<!-- ‚úÖ Toast th√¥ng b√°o -->
<div class="toast-container position-fixed bottom-0 end-0 p-3">
    <div id="cartToast" class="toast align-items-center text-bg-success border-0" role="alert">
        <div class="d-flex">
            <div class="toast-body fw-semibold"></div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Tooltip
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        tooltipTriggerList.map(function (el) { return new bootstrap.Tooltip(el) })

        // Toast gi·ªè h√†ng
        const cartToast = document.getElementById('cartToast');
        const cartToastBody = cartToast.querySelector('.toast-body');

        document.querySelectorAll('.add-to-cart-form').forEach(form => {
            form.addEventListener('submit', function (e) {
                e.preventDefault();
                const formData = new FormData(form);
                fetch(form.action, {
                    method: "POST",
                    body: formData,
                    headers: { 'X-Requested-With': 'XMLHttpRequest' }
                }).then(() => {
                    const productName = form.closest('.card').querySelector('.card-title').textContent;
                    cartToastBody.textContent = `ƒê√£ th√™m "${productName}" v√†o gi·ªè h√†ng!`;
                    const toast = new bootstrap.Toast(cartToast);
                    toast.show();
                });
            });
        });
    </script>
}


<style>
    .product-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
    }

    /* üåà Coupon Banner animation */
    @@keyframes pulse {
        0% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.05); opacity: 0.8; }
        100% { transform: scale(1); opacity: 1; }
    }

    .coupon-banner {
        background: linear-gradient(90deg, #eaffea, #ffffff);
        border-left: 5px solid #28a745;
        animation: pulse 2s infinite;
    }
</style>
